{
	"data": {
		"created_at": 1751345872,
		"created_by": "c85ba575-0a9f-4c7c-bc1b-95dc6810efaf",
		"description": "测试创建DB - API",
		"doc_form": null,
		"document_count": 0,
		"embedding_model": "bge-m3:latest",
		"embedding_model_provider": "langgenius/ollama/ollama",
		"id": "2d73baf5-015c-4632-adf8-45987e5e2c8e",
		"indexing_technique": "high_quality",
		"name": "test-db-12:57",
		"provider": "vendor",
		"retrieval_model_dict": {
			"score_threshold": 0.75,
			"score_threshold_enabled": true,
			"search_method": "semantic_search",
			"top_k": 3,
			"weights": null
		},
	},
	"info": "知识库创建成功!",
	"status_code": 0
}



'''shell    
curl --location --request POST 'http://localhost:80/v1/datasets/25ca2669-42cc-4e06-8de2-b7bb009c56a4/document/create_by_file' \
--header 'Authorization: Bearer dataset-BF2ihbySxTuftWOJnZMBTDTH' \
--form 'data={
  "indexing_technique": "high_quality",
  "process_rule": {
    "rules": {
      "pre_processing_rules": [
        {"id": "remove_extra_spaces", "enabled": true},
        {"id": "remove_urls_emails", "enabled": true}
      ],
      "segmentation": {
        "separator": "###",
        "max_tokens": 500
      }
    },
    "mode": "custom"
  }
};type=application/json' \
--form 'file=@"/home/git/files/长文-2.txt"'
'''



"""
from cdify.api.dbs.db_list import requests_datasets_list
already_dbs = requests_datasets_list() # db list

if dataset_id not in [i['id'] for i in already_dbs]:
    return {'status_code': -1, 'data': "", 'info': f'当前需要被删除的知识库ID {dataset_id} 不存在'}

if name in [i['name'] for i in already_dbs]:
    return {'status_code': -1, 'data': "", 'info': '知识库名称重复，请求改名称再进行创建'}
"""

chat_return_all_columns = {
	"event": "message",
	"task_id": "db82aad9-57f6-4197-badc-d2957ba93979",
	"id": "2a32e83f-66fe-4ff0-a91f-d522fdd18540",
	"message_id": "2a32e83f-66fe-4ff0-a91f-d522fdd18540",
	"conversation_id": "7c8645a3-98d1-4555-9888-f76513752671",
	"mode": "advanced-chat",
	"answer": "{\n  \"api\": \"ZHSC-0019\",\n  \"parameter\": []\n}",
	"metadata": {
		"retriever_resources": [
			{
				"position": 1,
				"dataset_id": "8ad0fda9-f1f0-413c-80fc-d776a4de2479",
				"dataset_name": "政务水务系统API-知识库-初版250607",
				"document_id": "c29e277f-76f4-431f-800e-057e5f8dc34c",
				"document_name": "api梳理.txt",
				"data_source_type": "upload_file",
				"segment_id": "37f524f4-3494-48f2-98c9-e472b8d92169",
				"retriever_from": "workflow",
				"score": 0.68382776,
				"hit_count": 3,
				"word_count": 68,
				"segment_position": 50,
				"index_node_hash": "5dd53ccd71637f2b41d1b2ae9f52506b8823794920686a891bc1d183ebf8b118",
				"content": "API：ZHSC-0019\n二水厂加氯间工艺总览\n二水厂加氯间运行态势图\n二水厂加氯间实时运行情况图\nparams:\nno_params",
				# "page": null,
				# "doc_metadata": null
			},
			{
				"position": 2,
				"dataset_id": "8ad0fda9-f1f0-413c-80fc-d776a4de2479",
				"dataset_name": "政务水务系统API-知识库-初版250607",
				"document_id": "c29e277f-76f4-431f-800e-057e5f8dc34c",
				"document_name": "api梳理.txt",
				"data_source_type": "upload_file",
				"segment_id": "c1838717-e4d9-4ee4-8931-796d4feeff03",
				"retriever_from": "workflow",
				"score": 0.62162852,
				"hit_count": 2,
				"word_count": 68,
				"segment_position": 41,
				"index_node_hash": "09af708a39e3ca5339443665811283c4f6591f615df2e54c5bda0b4944c5fd4b",
				"content": "API：ZHSC-0010\n二水厂加药间工艺总览\n二水厂加药间运行态势图\n二水厂加药间实时运行情况图\nparams:\nno_params",
				# "page": null,
				# "doc_metadata": null
			}
		],
		"usage": {
			"prompt_tokens": 1936,
			"prompt_unit_price": "0",
			"prompt_price_unit": "0",
			"prompt_price": "0",
			"completion_tokens": 412,
			"completion_unit_price": "0",
			"completion_price_unit": "0",
			"completion_price": "0",
			"total_tokens": 2348,
			"total_price": "0",
			"currency": "USD",
			"latency": 22.06833207514137
		}
	},
	"created_at": 1749607413
}
